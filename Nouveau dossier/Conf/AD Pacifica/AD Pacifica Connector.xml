<ConfigurationFile xmlns="urn:schemas-usercube-com:configuration">

  <!-- AD Pacifica Connector -->
  <Connector Identifier="ADPacifica" DisplayName_L1="AD Pacifica" Agent="CAA" />
  <Connection Connector="ADPacifica" DisplayName_L1="Connection Active Directory Pacifica" Identifier="ADPacificaExportFulfillment" Package="Usercube.AD@0000001"/>

  <EntityType Identifier="ADPacifica_Entry" DisplayName_L1="AD Pacifica - Entry" >
    <Property Identifier="accountExpires" DisplayName_L1="accountExpires" TargetColumnIndex="23" Type="String" />
    <Property Identifier="businessCategory" DisplayName_L1="businessCategory" TargetColumnIndex="55" Type="String" />
    <Property Identifier="c" DisplayName_L1="c" TargetColumnIndex="45" Type="String" />
    <Property Identifier="cn" DisplayName_L1="cn" TargetColumnIndex="10" Type="String" />
    <Property Identifier="comment" DisplayName_L1="comment" TargetColumnIndex="24" Type="String" />
    <Property Identifier="company" DisplayName_L1="company" TargetColumnIndex="25" Type="String" />
    <Property Identifier="department" DisplayName_L1="department" TargetColumnIndex="16" Type="String" />
	<Property Identifier="proxyaddresses" DisplayName_L1="proxyaddresses" TargetColumnIndex="1" Type="String" />
    <Property Identifier="displayName" DisplayName_L1="displayName" TargetColumnIndex="14" Type="String" />
    <Property Identifier="division" DisplayName_L1="division" TargetColumnIndex="28" Type="String" />
    <Property Identifier="dn" DisplayName_L1="dn" IsKey="true" TargetColumnIndex="0" Type="String" />
    <Property Identifier="employeeID" DisplayName_L1="employeeID" TargetColumnIndex="29" Type="String" />
    <Property Identifier="employeeNumber" DisplayName_L1="employeeNumber" TargetColumnIndex="30" Type="String" />
    <Property Identifier="employeeType" DisplayName_L1="employeeType" TargetColumnIndex="31" Type="String" />
    <Property Identifier="extensionattribute1" DisplayName_L1="extensionattribute1" TargetColumnIndex="40" Type="String" />
    <Property Identifier="extensionattribute2" DisplayName_L1="extensionattribute2" TargetColumnIndex="44" Type="String" />
	<Property Identifier="extensionattribute3" DisplayName_L1="extensionattribute3" TargetColumnIndex="46" Type="String" />
	<Property Identifier="extensionattribute14" DisplayName_L1="extensionattribute14" TargetColumnIndex="47" Type="String" />
    <Property Identifier="givenName" DisplayName_L1="givenName" TargetColumnIndex="21" Type="String" />
    <Property Identifier="groupType" DisplayName_L1="groupType" TargetColumnIndex="39" Type="String" />
    <Property Identifier="homeDirectory" DisplayName_L1="homeDirectory" TargetColumnIndex="41" Type="String" />
    <Property Identifier="homeDrive" DisplayName_L1="homeDrive" TargetColumnIndex="42" Type="String" />
    <Property Identifier="initials" DisplayName_L1="initials" TargetColumnIndex="33" Type="String" />
    <Property Identifier="l" DisplayName_L1="l" TargetColumnIndex="22" Type="String" />
    <Property Identifier="lastLogonTimestamp" DisplayName_L1="lastLogonTimestamp" TargetColumnIndex="34" Type="String" HistoryPrecision="10080" />
    <Property Identifier="mail" DisplayName_L1="mail" TargetColumnIndex="17" Type="String" />
    <Property Identifier="mobile" DisplayName_L1="mobile" TargetColumnIndex="18" Type="String" />
    <Property Identifier="objectCategory" DisplayName_L1="objectCategory" TargetColumnIndex="4" Type="String" />
    <Property Identifier="objectGuid" DisplayName_L1="objectGuid" TargetColumnIndex="3" Type="String" IsKey="true" />
    <Property Identifier="objectSid" DisplayName_L1="objectSid" TargetColumnIndex="9" Type="String" />
    <Property Identifier="ou" DisplayName_L1="ou" TargetColumnIndex="8" Type="String" />
    <Property Identifier="pwdLastSet" DisplayName_L1="pwdLastSet" TargetColumnIndex="13" Type="String" />
    <Property Identifier="rdn" DisplayName_L1="rdn" TargetColumnIndex="2" Type="String" />
    <Property Identifier="sAMAccountName" DisplayName_L1="sAMAccountName" TargetColumnIndex="11" Type="String" />
    <Property Identifier="scriptPath" DisplayName_L1="scriptPath" TargetColumnIndex="43" Type="String" />
    <Property Identifier="sn" DisplayName_L1="sn" TargetColumnIndex="20" Type="String" />
    <Property Identifier="st" DisplayName_L1="st" TargetColumnIndex="35" Type="String" />
    <Property Identifier="thumbnailPhoto" DisplayName_L1="thumbnailPhoto" Type="Binary" />
    <Property Identifier="thumbnailPhotoTag" DisplayName_L1="thumbnailPhoto Tag" Type="Int32" TargetColumnIndex="7" />
    <Property Identifier="telephoneNumber" DisplayName_L1="telephoneNumber" TargetColumnIndex="19" Type="String" />
    <Property Identifier="title" DisplayName_L1="title" TargetColumnIndex="36" Type="String" />
    <Property Identifier="uid" DisplayName_L1="uid" TargetColumnIndex="37" Type="String" />
    <Property Identifier="userAccountControl" DisplayName_L1="userAccountControl" TargetColumnIndex="15" Type="String" />
    <Property Identifier="userPrincipalName" DisplayName_L1="userPrincipalName" TargetColumnIndex="12" Type="String" />
    <Property Identifier="whenCreated" DisplayName_L1="whenCreated" TargetColumnIndex="5" Type="String" />

    <Property Identifier="isUnused" DisplayName_L1="isUnused" TargetColumnIndex="50" Type="Bool" />
    <Property Identifier="AppName" DisplayName_L1="AppName" TargetColumnIndex="51" Type="String" />

	<Property Identifier="flags" DisplayName_L1="flags" TargetColumnIndex="57" Type="String" />
	<Property Identifier="gcaattribute1" DisplayName_L1="gcaattribute1" TargetColumnIndex="58" Type="String" />
	<Property Identifier="mdboverhardquotalimit" DisplayName_L1="mdboverhardquotalimit" TargetColumnIndex="59" Type="String" />
	<Property Identifier="mdboverquotalimit" DisplayName_L1="mdboverquotalimit" TargetColumnIndex="60" Type="String" />
	<Property Identifier="mdbstoragequota" DisplayName_L1="mdbstoragequota" TargetColumnIndex="61" Type="String" />
	<Property Identifier="office" DisplayName_L1="office" TargetColumnIndex="62" Type="String" />
	<Property Identifier="pacaffichintra" DisplayName_L1="pacaffichintra" TargetColumnIndex="63" Type="String" />
	<Property Identifier="paciup" DisplayName_L1="paciup" TargetColumnIndex="64" Type="String" />
	<Property Identifier="pacmatricule" DisplayName_L1="pacmatricule" TargetColumnIndex="65" Type="String" />
	<Property Identifier="pacugs" DisplayName_L1="pacugs" TargetColumnIndex="66" Type="String" />
	<Property Identifier="physicaldeliveryofficename" DisplayName_L1="physicaldeliveryofficename" TargetColumnIndex="67" Type="String" />
    <Property Identifier="description" DisplayName_L1="description" TargetColumnIndex="68" Type="String" />

    <Property Identifier="parentdn" DisplayName_L1="parentdn" Type="ForeignKey" TargetColumnIndex="128" />
    <Property Identifier="children" DisplayName_L1="children" Type="ForeignKey" />
    <Property Identifier="member" DisplayName_L1="member" Type="ForeignKey" />
    <Property Identifier="memberOf" DisplayName_L1="memberOf" Type="ForeignKey" GroupByProperty="AppName"/>
    <Property Identifier="manager" DisplayName_L1="manager" Type="ForeignKey" TargetColumnIndex="129" />
    <Property Identifier="directReports" DisplayName_L1="directReports" Type="ForeignKey" />
    <Property Identifier="assistant" DisplayName_L1="assistant" TargetColumnIndex="130" Type="ForeignKey" />
    <Property Identifier="assistantOf" DisplayName_L1="assistantOf" Type="ForeignKey" />
  </EntityType>

  <EntityAssociation Identifier="ADPacifica_Entry_parentdn" DisplayName_L1="parentdn" IsProperty1Collection="true" Property2="ADPacifica_Entry:parentdn" Property1="ADPacifica_Entry:children" />
  <EntityAssociation Identifier="ADPacifica_Entry_member" DisplayName_L1="member" IsProperty1Collection="true" IsProperty2Collection="true" Property1="ADPacifica_Entry:member" Property2="ADPacifica_Entry:memberOf" />
  <EntityAssociation Identifier="ADPacifica_Entry_manager" DisplayName_L1="manager" IsProperty1Collection="true" Property2="ADPacifica_Entry:manager" Property1="ADPacifica_Entry:directReports" />
  <EntityAssociation Identifier="ADPacifica_Entry_assistant" DisplayName_L1="assistant" IsProperty1Collection="true" Property2="ADPacifica_Entry:assistant" Property1="ADPacifica_Entry:assistantOf" />

  <EntityTypeMapping Identifier="ADPacifica_Entry" Connector="ADPacifica" ConnectionTable="ADPacificaExportFulfillment_entries">
    <Property Identifier="accountExpires" ConnectionColumn="accountExpires" />
    <Property Identifier="c" ConnectionColumn="c" />
    <Property Identifier="cn" ConnectionColumn="cn" />
    <Property Identifier="comment" ConnectionColumn="comment" />
    <Property Identifier="company" ConnectionColumn="company" />
    <Property Identifier="proxyaddresses" ConnectionColumn="proxyaddresses" />
    <Property Identifier="description" ConnectionColumn="description" />
    <Property Identifier="displayName" ConnectionColumn="displayName" />
    <Property Identifier="division" ConnectionColumn="division" />
    <Property Identifier="dn" ConnectionColumn="dn" IsUniqueKey="true" />
    <Property Identifier="employeeID" ConnectionColumn="employeeID" />
    <Property Identifier="employeeNumber" ConnectionColumn="employeeNumber" />
    <Property Identifier="employeeType" ConnectionColumn="employeeType" />
    <Property Identifier="extensionattribute1" ConnectionColumn="extensionattribute1" />
    <Property Identifier="extensionattribute2" ConnectionColumn="extensionattribute2" />
	<Property Identifier="extensionattribute3" ConnectionColumn="extensionattribute3" />
    <Property Identifier="extensionattribute14" ConnectionColumn="extensionattribute14" />
    <Property Identifier="givenName" ConnectionColumn="givenName" />
    <Property Identifier="groupType" ConnectionColumn="groupType" />
    <Property Identifier="homeDirectory" ConnectionColumn="homeDirectory" />
    <Property Identifier="homeDrive" ConnectionColumn="homeDrive" />
    <Property Identifier="initials" ConnectionColumn="initials" />
    <Property Identifier="l" ConnectionColumn="l" />
    <Property Identifier="lastLogonTimestamp" ConnectionColumn="lastLogonTimestamp" />
    <Property Identifier="mail" ConnectionColumn="mail" />
    <Property Identifier="mobile" ConnectionColumn="mobile" />
    <Property Identifier="objectCategory" ConnectionColumn="objectCategory" Format="rdn" />
    <Property Identifier="objectGuid" ConnectionColumn="objectGUID" IsPrimaryKey="true" Format="guid" />
    <Property Identifier="objectSid" ConnectionColumn="objectSid" IsUniqueKey="true" Format="sid"/>
    <Property Identifier="ou" ConnectionColumn="ou" />
    <Property Identifier="pwdLastSet" ConnectionColumn="pwdLastSet" Format="1601date" />
    <Property Identifier="rdn" ConnectionColumn="name" />
    <Property Identifier="sAMAccountName" ConnectionColumn="sAMAccountName" />
    <Property Identifier="scriptPath" ConnectionColumn="scriptPath" />
    <Property Identifier="sn" ConnectionColumn="sn" />
    <Property Identifier="st" ConnectionColumn="st" />
    <Property Identifier="telephoneNumber" ConnectionColumn="telephoneNumber" />
    <Property Identifier="thumbnailPhoto" ConnectionColumn="thumbnailPhoto" Format="binary" />
    <Property Identifier="title" ConnectionColumn="title" />
    <Property Identifier="uid" ConnectionColumn="uid" />
    <Property Identifier="userAccountControl" ConnectionColumn="userAccountControl" />
    <Property Identifier="userPrincipalName" ConnectionColumn="userPrincipalName" />
    <Property Identifier="whenCreated" ConnectionColumn="whenCreated" />
	<Property Identifier="flags" ConnectionColumn="flags" />
	<Property Identifier="gcaattribute1" ConnectionColumn="gcaattribute1" />
	<Property Identifier="mdboverhardquotalimit" ConnectionColumn="mdboverhardquotalimit" />
	<Property Identifier="mdboverquotalimit" ConnectionColumn="mdboverquotalimit" />
	<Property Identifier="mdbstoragequota" ConnectionColumn="mdbstoragequota" />
	<Property Identifier="office" ConnectionColumn="office" />
	<Property Identifier="pacaffichintra" ConnectionColumn="pacaffichintra" />
	<Property Identifier="paciup" ConnectionColumn="paciup" />
	<Property Identifier="pacmatricule" ConnectionColumn="pacmatricule" />
	<Property Identifier="pacugs" ConnectionColumn="pacugs" />
	<Property Identifier="physicaldeliveryofficename" ConnectionColumn="physicaldeliveryofficename" />
	<Property Identifier="description" ConnectionColumn="description" />
  </EntityTypeMapping>

  <EntityAssociationMapping Identifier="ADPacifica_Entry_parentdn" Column2="dn" Column1="parentdn" ConnectionTable="ADPacificaExportFulfillment_entries" EntityPropertyMapping1="ADPacifica_Entry:dn" EntityPropertyMapping2="ADPacifica_Entry:dn" Connector="ADPacifica" />
  <EntityAssociationMapping Identifier="ADPacifica_Entry_member" Column1="dn" Column2="member" ConnectionTable="ADPacificaExportFulfillment_member" EntityPropertyMapping1="ADPacifica_Entry:dn" EntityPropertyMapping2="ADPacifica_Entry:dn" Connector="ADPacifica" />
  <EntityAssociationMapping Identifier="ADPacifica_Entry_manager" Column2="dn" Column1="manager" ConnectionTable="ADPacificaExportFulfillment_manager" EntityPropertyMapping1="ADPacifica_Entry:dn" EntityPropertyMapping2="ADPacifica_Entry:dn" Connector="ADPacifica" />
  <EntityAssociationMapping Identifier="ADPacifica_Entry_assistant" Connector="ADPacifica" ConnectionTable="ADPacificaExportFulfillment_entries" Column2="objectGUID" Column1="assistant"  EntityPropertyMapping1="ADPacifica_Entry:dn" EntityPropertyMapping2="ADPacifica_Entry:objectGuid" />

  <EntityPropertyExpression Identifier="ADPacifica_Entry_isUnused" Expression="C#:resource:
      if (resource.userAccountControl == null) {
        return false;
      }
      if ((int.Parse(resource.userAccountControl) &amp; 2) != 0) {
        return false;
      }
      if (resource.accountExpires != null &amp;&amp; resource.accountExpires != &quot;0&quot; &amp;&amp; resource.accountExpires != &quot;9223372036854775807&quot; &amp;&amp; Usercube.Expressions.Functions.UtilExpressions.ParseSince1601Date(resource.accountExpires) &lt; DateTime.UtcNow) {
        return false;
      }

    return ((resource.lastLogonTimestamp == null) || (Usercube.Expressions.Functions.UtilExpressions.ParseSince1601Date(resource.lastLogonTimestamp) &lt; DateTime.UtcNow.AddMonths(-6)));
  " EntityType="ADPacifica_Entry" Property="isUnused" />

  <ViewTargetResourceTemplate EntityType="ADPacifica_Entry" Profile="Administrator" />
  <TargetResourceReport EntityType="ADPacifica_Entry" />
  <TargetResourceReportAccessControlRules EntityType="ADPacifica_Entry" Profile="Administrator" />
  <TargetResourceReportMenus EntityType="ADPacifica_Entry" />

</ConfigurationFile>
